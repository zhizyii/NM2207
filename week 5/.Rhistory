add_resource("Teller2", 2) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240)
}
set.seed(1109)
env1 <- replicate(50, rep())
env1_arrivals <- get_mon_arrivals(env1)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
library(simmer)
library(dplyr)
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function(){runif(1) <= 0.1}) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
bank <- simmer("Bank") %>%
add_resource("Teller1", 3) %>%
add_resource("Teller2", 2) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240)
}
set.seed(1109)
env1 <- replicate(50, rep())
library(simmer)
library(dplyr)
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1), continue=FALSE,
library(simmer)
library(dplyr)
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1), continue=FALSE,
library(simmer)
library(dplyr)
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1), continue=FALSE,
library(simmer)
library(dplyr)
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1), continue=FALSE,
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1), continue=FALSE,
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,          trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
library(simmer)
library(dplyr)
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,          trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
bank <- simmer("Bank") %>%
add_resource("Teller1", 3) %>%
add_resource("Teller2", 2) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240)
}
set.seed(1109)
env1 <- replicate(50, rep())
env1_arrivals <- get_mon_arrivals(env1)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,          trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
bank <- simmer("Bank") %>%
add_resource("Teller1", 3) %>%
add_resource("Teller2", 2) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240)
}
set.seed(1109)
env1 <- replicate(50, rep())
env1_arrivals <- get_mon_arrivals(env1)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
library(simmer)
library(dplyr)
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/10)}
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
bank <- simmer("Bank") %>%
add_resource("Teller1", 3) %>%
add_resource("Teller2", 2) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240)
}
set.seed(1109)
env1 <- replicate(50, rep())
env1_arrivals <- get_mon_arrivals(env1)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
library(simmer)
library(dplyr)
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/10)}
rep <- function(){
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
bank <- simmer("Bank") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240)
}
set.seed(1109)
env1 <- replicate(50, rep())
env1_arrivals <- get_mon_arrivals(env1)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,          trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240) %>% wrap()
)
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,          trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240) %>% wrap()
)
env1_arrivals <- get_mon_arrivals(mm1.envs)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,          trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240) %>% wrap()
)
set.seed(1109)
env1_arrivals <- get_mon_arrivals(mm1.envs)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,
trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240) %>% wrap()
)
set.seed(1109)
env1_arrivals <- get_mon_arrivals(mm1.envs)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,
trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240) %>% wrap()
)
set.seed(1109)
env1_arrivals <- get_mon_arrivals(mm1.envs)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
mean_wait_time
mean_wait_time <- mean(w_vec)
mean_wait_time
knitr::opts_chunk$set(echo = TRUE)
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,
trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240) %>% wrap()
)
set.seed(1109)
env1_arrivals <- get_mon_arrivals(mm1.envs)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,
trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, function(){rexp(n=1, rate = 1/10)}) %>%
run(until=240) %>% wrap()
)
set.seed(1109)
env1_arrivals <- get_mon_arrivals(mm1.envs)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,
trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, function(){rexp(n=1, rate = 1/8)}) %>%
run(until=240) %>% wrap()
)
set.seed(1109)
env1_arrivals <- get_mon_arrivals(mm1.envs)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,
trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals}) %>%
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,
trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals()}) %>%
task1_duration <- function() rexp(n = 1, rate = 1/12)
task2_duration <- function() rexp(n = 1, rate = 1/10)
gen_arrivals <- function(){rexp(n=1, rate = 1/8)}
#create customer trajectory
customer <- trajectory("Customer") %>%
seize("Teller1") %>%
timeout(task1_duration) %>%
release("Teller1") %>%
branch(function() runif(1) <= 0.1, continue = FALSE,
trajectory()) %>%
seize("Teller2") %>%
timeout(task2_duration) %>%
release("Teller2")
#create simulation environment
mm1.envs <- replicate(50,
simmer("mixer") %>%
add_resource("Teller1", 1) %>%
add_resource("Teller2", 1) %>%
add_generator("Customer", customer, gen_arrivals) %>%
run(until=240) %>% wrap()
)
set.seed(1109)
env1_arrivals <- get_mon_arrivals(mm1.envs)
w_vec <- env1_arrivals %>%
mutate(wait_time = end_time - (start_time + activity_time))  %>%
group_by(replication) %>%
summarise(mean_wait_time = mean(wait_time)) %>%
dplyr::select(mean_wait_time) %>%
unlist
mean_wait_time <- mean(w_vec)
mean_wait_time
